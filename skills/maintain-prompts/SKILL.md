---
name: maintain-prompts
description: AI-Toolkitのプロンプトをメンテナンス・リファクタリング。スラッシュコマンド・Skill・サブエージェントの作成・設計時にベストプラクティスも提供。「プロンプトメンテナンス」「責務分離」「maintain-prompts」「コマンド作成」「スラッシュコマンド」「Skill作成」「エージェント作成」「サブエージェント」「ベストプラクティス」等のキーワードで自動適用。
allowed-tools: Read, Write, Edit, Bash, Task, Glob
user-invocable: true
---

# プロンプトメンテナンス & ベストプラクティス

## 概要

AI-Toolkitリポジトリ内のスラッシュコマンド、タスクファイル、Skills、サブエージェントを分析し、
責務分離の原則とClaude公式ベストプラクティスに沿って最適化・改善を行います。

また、スラッシュコマンド・Skill・サブエージェントの**作成・設計時にはベストプラクティス**を提供します。
詳細は [BEST-PRACTICES.md](BEST-PRACTICES.md) を参照してください。

日本語で回答すること。

## ワークフロー

**以下のチェックリストをコピーして進行状況を追跡すること：**

```
メンテナンス進捗：
- [ ] Phase 1: 現状分析（スクリプト実行）
- [ ] Phase 2: 計画立案（Planサブエージェント）
- [ ] Phase 3: ユーザー承認の取得
- [ ] Phase 4: 修正実施
- [ ] Phase 5: 検証と完了報告
```

## 責務定義

各リソースタイプの責務は以下の通りです。違反がないかチェックしてください。

| リソース | 責務 | 違反例 |
|----------|------|--------|
| **Skills** | 自動発火の"入口"（検出→ルーティング） | 具体的な処理ロジックを持ちすぎている |
| **Slash-commands** | 明示実行の"プロダクト機能"（UX窓口） | 再利用可能な手順を直接記述している |
| **Task** | 再利用する"手順ライブラリ"（安定・単機能） | 1箇所からしか呼ばれない / 複数責務を持つ |
| **Agents** | 思考/口調/観点の"モジュール"（工程単位） | 汎用的すぎる / 専門性がない |

## Phase 1: 現状分析

```
Phase 1 チェックリスト：
- [ ] 分析スクリプトを実行
- [ ] summary（ファイル数サマリー）を確認
- [ ] quality_issues（品質問題一覧）を確認
- [ ] refactoring_candidates（リファクタリング候補）を確認
- [ ] reference_map（task参照関係）を確認
```

**実行コマンド**:
```bash
python3 ~/Documents/Git/ai-toolkit/skills/maintain-prompts/analyze_prompts.py
```

## Phase 2: 計画立案

```
Phase 2 チェックリスト：
- [ ] Planサブエージェントを起動
- [ ] 統合候補（task → コマンドに統合）を特定
- [ ] 抽出候補（インライン処理 → task化）を特定
- [ ] Skills昇格候補を特定
- [ ] Agent化候補を特定
- [ ] 責務違反の修正箇所を特定
- [ ] 品質問題の修正箇所を特定
```

Taskツールを使用してPlanサブエージェントを起動し、以下の形式で計画を作成させる：

```
AI-Toolkitリポジトリのプロンプトメンテナンス計画を立ててください。

## 現状分析結果
{phase1_analysis_result}

## メンテナンス方針
1. 責務分離の原則に基づくリファクタリング
2. Claude公式ベストプラクティス準拠
3. READMEとの整合性確保

## 出力形式

### 1. 統合候補（task → コマンドに統合）
### 2. 抽出候補（インライン処理 → task化）
### 3. Skills昇格候補
### 4. Agent化候補
### 5. 責務違反の修正
### 6. 品質問題の修正
```

## Phase 3: ユーザー承認

```
Phase 3 チェックリスト：
- [ ] 計画をユーザーに提示
- [ ] ユーザーからの承認を取得
- [ ] 修正点があれば計画を更新
```

**重要**: 修正は必ずユーザーの承認を得てから実施する。

## Phase 4: 修正実施

```
Phase 4 チェックリスト：
- [ ] 責務違反の修正（アーキテクチャ整合性）
- [ ] 統合（不要ファイル削除でシンプル化）
- [ ] 抽出（重複排除）
- [ ] Skills昇格
- [ ] Agent化
- [ ] 品質問題の修正
```

**優先順位**: 上から順に実施する。

## Phase 5: 検証と完了報告

```
Phase 5 チェックリスト：
- [ ] 依存関係の再検証（壊れた参照がないか）
- [ ] README記載内容との整合性確認
- [ ] 完了報告
```

## 判断基準

### Skills昇格の判断基準

| 基準 | 説明 | 重み |
|------|------|------|
| 再利用性 | 複数のコマンドから参照されている | 高 |
| 自動発動適性 | URL・ファイルタイプ・キーワードで発動可能 | 高 |
| 独立性 | 単独で完結するワークフロー | 中 |
| 汎用性 | プロジェクトを跨いで使用可能 | 中 |

### Agent化の判断基準

| 基準 | 説明 |
|------|------|
| 専門的思考が必要 | 特定ドメインの判断・分析が必要 |
| 独自の観点/口調 | 一貫したペルソナやレビュー観点を持つ |
| コンテキスト分離 | 親タスクと独立して動作すべき |
| 並列実行の利点 | 他の処理と並行して実行できる |

## 注意事項

- 実際の修正は必ずユーザーの承認を得てから行う
- 大きな変更を行う場合は、段階的に実施することを提案する
- 不明な点がある場合は、推測せずユーザーに確認する
