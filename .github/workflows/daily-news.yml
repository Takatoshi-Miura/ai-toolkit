name: Daily Yahoo News Fetcher

on:
  # æ¯æœ6æ™‚ï¼ˆJSTï¼‰ã«å®Ÿè¡Œ = UTC 21æ™‚ï¼ˆå‰æ—¥ï¼‰
  schedule:
    - cron: '0 21 * * *'
  # æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½
  workflow_dispatch:

permissions:
  issues: write
  contents: read

jobs:
  fetch-news:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          pip install requests beautifulsoup4 lxml

      - name: Fetch Yahoo News (å®Œå…¨ç„¡æ–™ç‰ˆ)
        id: fetch_news
        run: |
          python scripts/fetch_yahoo_news.py

      - name: Create GitHub Issue with News
        env:
          GH_TOKEN: ${{ github.token }}
        run: |
          # çµæœãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ Issue ã‚’ä½œæˆ
          TITLE="ğŸ“° Yahoo ãƒ‹ãƒ¥ãƒ¼ã‚¹ - $(TZ=Asia/Tokyo date '+%Yå¹´%mæœˆ%dæ—¥')"
          gh issue create \
            --title "$TITLE" \
            --body-file news_output.md \
            --label "news,automated"
