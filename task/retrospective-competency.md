# retrospective-competency コマンド用タスク

## 概要
前日のClaude Code使用履歴とノートの振り返り記録を分析し、コンピテンシー評価基準に照らし合わせて該当する行動があったかを判定する。
評価基準ごとに該当する活動をマッピングして、評価面談時に活用できるエビデンスとして提示する。

## 前提条件

### コンピテンシー評価基準ドキュメント
- URL: https://docs.google.com/document/d/1iVeZ1EB5dahEZukuQQB4gSa5jIw3By-Gz8JaAysiAoA/edit
- 対象タブ: 「今年の目標」内の「仕事:コンピテンシー評価基準」セクション

## 手順

### Phase 1: 前日のClaude Code使用履歴の取得

**参照タスク**: `~/Documents/Git/ai-toolkit/task/retrospective-claude-usage-daily.md`

1. 上記タスクの Phase 1 に従って、前日のセッション履歴を取得する
   - 前日のタイムスタンプ計算
   - `~/.claude/history.jsonl`からの履歴抽出
   - セッションIDのユニーク一覧取得

2. 上記タスクの Phase 2 に従って、活動内容を分類・集計する
   - 活動内容のカテゴライズ
   - プロジェクト別の活動集計
   - 時間帯分析

### Phase 2: ノートとコンピテンシー評価基準の読み取り

**参照タスク**: `~/Documents/Git/ai-toolkit/task/read-note.md`

3. 上記タスクに従って、ノートの「今年の目標」タブと当月タブを読み取る

   **「今年の目標」タブから抽出する情報**:
   - 「仕事:コンピテンシー評価基準」セクションの各評価項目
   - 項目ごとの評価指標・定義
   - マッピング用のチェックリストを作成

   **当月タブから抽出する情報**:
   - 日次の振り返り記録（前日分があれば重点的に確認）
   - 実施した業務内容
   - 達成した成果
   - 学んだこと・気づき
   - 課題や改善点
   - チームへの貢献

### Phase 3: 履歴・ノートと評価基準のマッピング

4. 活動内容を評価基準に照らし合わせて分類する

   前日の各セッションおよびノートの記録について、以下の一般的な観点で分析:

   - **技術力・専門性**: コーディング、実装、バグ修正、技術調査、コードレビュー等
   - **問題解決能力**: トラブルシューティング、エラー解決、課題分析等
   - **コミュニケーション**: ドキュメント作成、PR作成、レビューコメント等
   - **自律性・主体性**: 自主的な改善提案、プロセス改善、効率化等
   - **チームワーク**: コラボレーション、知識共有、レビュー対応等
   - **学習意欲・成長志向**: 新技術の学習、スキルアップ活動、調査等

   **注意**: 上記は一般的な観点例。実際のコンピテンシー項目に合わせて柔軟に分類すること。

5. エビデンスの抽出

   各コンピテンシー項目に対して、該当する具体的な活動を記録:

   **Claude Code履歴からのエビデンス**:
   - セッションの時刻
   - プロジェクト名
   - 実施した内容（displayから抽出）
   - なぜその行動が評価基準に該当するかの理由

   **ノートからのエビデンス**:
   - 記載日
   - 活動内容・成果
   - 学びや気づき
   - なぜその行動が評価基準に該当するかの理由

### Phase 4: レポート作成

6. レポートファイルの作成

   `~/Downloads/yyyyMMdd-competency-evidence.md`（yyyyMMddは前日の日付）に以下の構成でMarkdownレポートを作成:

   ```markdown
   # コンピテンシー評価エビデンス（前日分）

   **対象日**: YYYY年MM月DD日（前日）
   **レポート作成日時**: YYYY-MM-DD HH:MM:SS

   ---

   ## サマリー
   - **総セッション数**: N回
   - **活動時間帯**: HH:MM ～ HH:MM
   - **主な作業プロジェクト**: プロジェクト名
   - **ノート記録**: あり/なし
   - **該当したコンピテンシー項目数**: N項目

   ---

   ## コンピテンシー別エビデンス

   ### [コンピテンシー項目名1]

   #### 評価基準（抜粋）
   （ドキュメントから該当部分を引用）

   #### 該当する活動

   **Claude Code履歴より**
   - **時刻**: HH:MM
   - **プロジェクト**: プロジェクト名
   - **活動内容**: （displayの内容を要約）
   - **評価ポイント**: なぜこの活動が評価基準に該当するかの説明

   **ノート記録より**
   - **記載日**: YYYY-MM-DD
   - **活動内容**: （ノートの記載内容を要約）
   - **評価ポイント**: なぜこの活動が評価基準に該当するかの説明

   （該当する活動が複数ある場合は繰り返し記載）

   ---

   ### [コンピテンシー項目名2]

   （同様に記載）

   ---

   ## 該当しなかったコンピテンシー項目
   - [項目名]: （前日の活動では該当する行動が見られませんでした）

   ---

   ## 総合的な考察

   ### 強みとして発揮できた点
   （前日の活動から見られた強み）

   ### 今後意識すべき点
   （該当しなかった項目について、今後どのような行動を取るべきか）

   ### 評価面談での活用方法
   （このレポートをどう活用するかの提案）

   ---

   ## 活動詳細（参考）

   ### 時系列活動ログ（Claude Code）
   - HH:MM - [プロジェクト名] 入力内容の要約
   - HH:MM - [プロジェクト名] 入力内容の要約
   （時系列で全セッションを記載）

   ### ノート記録（当月分）
   - YYYY-MM-DD: 記載内容の要約
   （該当する記録を記載）
   ```

7. 継続的な活用のアドバイス

    レポートの最後に以下を追記:
    - 定期的（週次/月次）にレポートを見返して蓄積する方法
    - 評価面談時の効果的な活用方法
    - コンピテンシー向上のための行動計画の立て方

## 技術的な考慮事項

### タイムスタンプの扱い
- `retrospective-claude-usage-daily.md`の技術的考慮事項を参照

### Google Drive APIの活用
- `read-google-drive.md`の手順を参照
- `mcp__mcp-google-drive__g_drive_get_file_structure` でタブ構造を取得
- `mcp__mcp-google-drive__g_drive_read_file_part` で特定タブを読み取り

### エラーハンドリング
- 前日のセッションが存在しない場合:「前日は活動記録がありません」と表示
- ノートに前日分の記録がない場合: 当月の直近の記録を参照する旨を表示
- Google Driveドキュメントへのアクセスに失敗した場合: エラーメッセージを表示し、再認証を促す
- コンピテンシー評価基準のセクションが見つからない場合: ドキュメント構造を表示し、ユーザーに確認を求める

## 拡張可能性（将来オプション）

### 期間指定オプション
- `--last-7days`: 過去7日間の累積エビデンス
- `--last-30days`: 過去30日間の累積エビデンス
- `--since YYYY-MM-DD`: 指定日以降の累積エビデンス

### 出力形式オプション
- Markdown（デフォルト）
- JSON（プログラマティックな処理用）
- PDF（評価面談資料として直接利用）
